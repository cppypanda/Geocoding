# 智能地址情报三步骤功能使用说明

基于 `docs/SOP_POI_Web_Assisted_Selection.md` 实现的智能地址情报三步骤功能已经集成到系统中。

## 功能概述

智能地址情报功能通过三个步骤对地址进行深度分析和POI匹配验证：

1. **第一步：网络信息搜集与摘录** - 通过网络搜索获取地址的详细信息
2. **第二步：POI候选符合度判断** - 基于搜集的信息验证现有POI是否符合
3. **第三步：搜索关键词建议** - 当POI不符合时生成更有效的搜索关键词

## 使用流程

### 1. 访问功能

1. 在地理编码结果页面，点击 **"逐条查看与校准"**
2. 在校准界面中，点击 **"地址查找工具"** 按钮
3. 在弹出的工具栏中，切换到 **"智能地址情报"** 标签页

### 2. 第一步：信息搜集

1. 系统会自动显示当前正在分析的地址
2. 点击 **"开始搜集信息"** 按钮（消耗积分）
3. 系统将进行网络搜索并摘录相关地址信息
4. 搜集完成后，会显示摘录的信息列表，包括来源

### 3. 第二步：POI验证

1. 确保已完成第一步信息搜集
2. 确保POI地图搜索已有结果
3. 点击 **"验证POI候选"** 按钮
4. 系统会基于搜集的信息验证POI候选列表
5. 如果找到匹配的POI，会显示推荐结果和理由
6. 如果没有匹配的POI，会显示不匹配的原因

### 4. 第三步：关键词建议

1. 只有在第二步验证无匹配POI时才会启用
2. 点击 **"生成关键词建议"** 按钮
3. 系统会基于搜集的信息生成更有效的搜索关键词
4. 每个关键词建议包含：
   - 具体关键词
   - 选择理由
   - 搜索策略类型
5. 可以点击 **"使用此关键词搜索"** 直接在POI搜索中使用该关键词

## 技术实现

### 后端API端点

- `POST /geocode/web_intelligence/search_collate` - 第一步：搜集摘录
- `POST /geocode/web_intelligence/validate_candidates` - 第二步：验证候选
- `POST /geocode/web_intelligence/suggest_keywords` - 第三步：关键词建议

### 前端模块

- `static/js/modules/web-intelligence.js` - 主要的三步骤管理模块
- 集成到 `calibration.js` 中的地址查找工具
- 在 `features.js` 中的辅助函数

### CSS样式

- 步骤导航样式
- 摘录信息显示样式
- 验证结果样式
- 关键词建议样式

## 注意事项

1. **积分消耗**：第一步信息搜集需要消耗积分
2. **前置条件**：第二步需要完成第一步，第三步需要第二步验证无匹配
3. **数据流**：当前地址和POI候选会自动从校准界面传递到智能地址情报
4. **用户体验**：每个步骤都有清晰的状态指示和进度反馈

## 故障排除

1. **按钮无响应**：检查是否满足前置条件
2. **搜集信息失败**：检查网络连接和积分余额
3. **验证结果异常**：确保POI搜索结果存在
4. **关键词建议为空**：检查第一步是否成功搜集到信息

## 扩展功能

- 可以在关键词建议中直接点击使用关键词进行POI搜索
- 验证成功的POI会在搜索结果中高亮提示
- 支持步骤间的灵活导航和状态保持
